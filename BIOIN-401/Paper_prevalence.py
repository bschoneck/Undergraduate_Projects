#!/usr/local/bin/python3
# GENERATE FIGURE 2B

from collections import Counter
from operator import itemgetter
import time

# Run 1
#metagenome = "ERR321426,ERR209383,ERR526022,ERR321280,ERR321249,ERR209641,ERR209133,ERR209243,ERR321407,ERR866584,ERR321101,ERR209751,ERR209636,ERR321250,ERR321415,ERR209647,ERR321367,ERR209303,ERR209358,SRR492183,ERR011114,ERR321310,ERR209232,ERR209575,ERR209082,SRR492065,ERR209794,ERR209396,ERR321427,ERR209242,ERR321540,ERR011126,ERR321406,ERR209530,ERR321412,ERR209085,ERR321358,ERR209602,ERR321251,ERR321067,ERR414350,ERR209244,ERR321366,ERR209585,ERR321414,ERR526025,ERR321084,SRR492182,ERR209227,ERR209610,ERR209206,ERR321089,ERR321106,ERR011131,ERR209369,ERR321141,ERR209125,SRR769534,ERR209077,ERR321338,ERR209676,ERR209222,ERR414270,ERR209236,ERR321515,ERR011109,ERR011092,ERR209203,ERR209109,ERR321392,ERR209753,ERR209099,ERR209785,ERR209779,ERR866580,ERR209094,ERR321460,ERR209230,ERR209760,ERR209349,ERR209417,ERR209147,ERR209153,ERR011166,ERR321428,ERR209216,ERR321351,SRR492194,ERR011117,ERR321092,SRR585752,ERR209501,ERR011335,ERR321326,ERR209210,ERR414505,ERR209557,ERR209822,ERR321307,ERR209155"

# Run 2
#metagenome = "ERR209112,ERR321206,ERR209795,ERR209106,ERR209239,ERR209180,ERR209149,ERR209868,ERR209059,SRR609146,ERR209685,ERR209150,ERR011308,ERR209293,ERR321378,ERR321470,ERR209144,ERR209121,ERR209787,ERR414258,ERR209142,ERR209743,ERR209096,ERR209177,ERR209864,ERR209113,ERR209418,ERR209181,ERR209238,ERR209689,ERR209750,ERR414300,SRR600047,SRR605618,ERR209151,ERR209771,ERR209302,SRR599841,ERR321165,SRR585750,ERR209143,ERR209139,ERR209294,ERR209162,SRR585727,ERR209097,SRR609141,ERR209705,SRR585760,ERR321405,ERR209724,ERR209104,SRR599573,ERR209571,ERR209167,SRR585758,ERR209459,SRR585747,ERR209159,ERR209645,ERR209184,ERR321129,ERR011190,ERR209681,SRR605579,ERR209140,ERR011154,ERR414324,ERR209704,ERR209333,ERR321482,SRR492192,ERR209866,ERR321301,ERR209752,SRR605582,ERR209179,ERR209723,ERR209737,ERR209321,ERR414508,ERR209122,ERR209191,ERR321416,ERR209754,SRR605584,ERR414238,ERR209775,ERR011231,ERR209680"

# Run 3
#metagenome = "ERR209218,ERR011089,ERR209397,ERR321118,ERR209525,ERR321541,ERR209463,ERR321517,ERR209165,ERR209798,ERR209220,ERR209199,ERR866578,ERR321316,ERR321292,ERR321401,ERR209391,ERR321420,ERR209450,ERR209406,ERR011281,ERR321256,ERR414260,ERR209449,ERR209269,ERR321457,ERR321505,ERR209382,ERR209331,ERR321341,ERR209780,ERR321360,ERR011256,ERR209060,ERR526054,ERR321391,ERR209799,ERR321502,ERR321400,ERR321435,ERR321329,ERR011143,ERR209541,ERR321419,ERR321276,ERR209448,ERR209738,ERR321456,ERR866577,ERR321231,ERR321539,ERR209131,ERR321363,ERR321518,ERR209395,SRR492066,ERR209402,ERR209416,ERR321064,ERR321321,ERR866592,ERR209393,ERR321172,ERR209334,SRR492195,ERR209208,ERR209409,SRR769526,ERR321259,ERR321403,ERR209592,ERR209137,ERR209357,ERR209404,ERR209224,ERR321254,ERR321474,ERR011197,ERR321376,ERR209057,ERR209111,ERR321519,ERR321473,ERR209491,ERR209344,ERR209811,ERR321279,ERR321345,ERR321459,ERR321402,ERR011252,ERR321291,ERR209300,ERR321364,ERR321260,ERR321255,ERR321475,ERR209319,ERR321461,ERR321288"

# Run 4 Total
#metagenome = "ERR321426,ERR209383,ERR526022,ERR321280,ERR321249,ERR209641,ERR209133,ERR209243,ERR321407,ERR866584,ERR321101,ERR209751,ERR209636,ERR321250,ERR321415,ERR209647,ERR321367,ERR209303,ERR209358,SRR492183,ERR011114,ERR321310,ERR209232,ERR209575,ERR209082,SRR492065,ERR209794,ERR209396,ERR321427,ERR209242,ERR321540,ERR011126,ERR321406,ERR209530,ERR321412,ERR209085,ERR321358,ERR209602,ERR321251,ERR321067,ERR414350,ERR209244,ERR321366,ERR209585,ERR321414,ERR526025,ERR321084,SRR492182,ERR209227,ERR209610,ERR209206,ERR321089,ERR321106,ERR011131,ERR209369,ERR321141,ERR209125,SRR769534,ERR209077,ERR321338,ERR209676,ERR209222,ERR414270,ERR209236,ERR321515,ERR011109,ERR011092,ERR209203,ERR209109,ERR321392,ERR209753,ERR209099,ERR209785,ERR209779,ERR866580,ERR209094,ERR321460,ERR209230,ERR209760,ERR209349,ERR209417,ERR209147,ERR209153,ERR011166,ERR321428,ERR209216,ERR321351,SRR492194,ERR011117,ERR321092,SRR585752,ERR209501,ERR011335,ERR321326,ERR209210,ERR414505,ERR209557,ERR209822,ERR321307,ERR209155,ERR209112,ERR321206,ERR209795,ERR209106,ERR209239,ERR209180,ERR209149,ERR209868,ERR209059,SRR609146,ERR209685,ERR209150,ERR011308,ERR209293,ERR321378,ERR321470,ERR209144,ERR209121,ERR209787,ERR414258,ERR209142,ERR209743,ERR209096,ERR209177,ERR209864,ERR209113,ERR209418,ERR209181,ERR209238,ERR209689,ERR209750,ERR414300,SRR600047,SRR605618,ERR209151,ERR209771,ERR209302,SRR599841,ERR321165,SRR585750,ERR209143,ERR209139,ERR209294,ERR209162,SRR585727,ERR209097,SRR609141,ERR209705,SRR585760,ERR321405,ERR209724,ERR209104,SRR599573,ERR209571,ERR209167,SRR585758,ERR209459,SRR585747,ERR209159,ERR209645,ERR209184,ERR321129,ERR011190,ERR209681,SRR605579,ERR209140,ERR011154,ERR414324,ERR209704,ERR209333,ERR321482,SRR492192,ERR209866,ERR321301,ERR209752,SRR605582,ERR209179,ERR209723,ERR209737,ERR209321,ERR414508,ERR209122,ERR209191,ERR321416,ERR209754,SRR605584,ERR414238,ERR209775,ERR011231,ERR209680,ERR209218,ERR011089,ERR209397,ERR321118,ERR209525,ERR321541,ERR209463,ERR321517,ERR209165,ERR209798,ERR209220,ERR209199,ERR866578,ERR321316,ERR321292,ERR321401,ERR209391,ERR321420,ERR209450,ERR209406,ERR011281,ERR321256,ERR414260,ERR209449,ERR209269,ERR321457,ERR321505,ERR209382,ERR209331,ERR321341,ERR209780,ERR321360,ERR011256,ERR209060,ERR526054,ERR321391,ERR209799,ERR321502,ERR321400,ERR321435,ERR321329,ERR011143,ERR209541,ERR321419,ERR321276,ERR209448,ERR209738,ERR321456,ERR866577,ERR321231,ERR321539,ERR209131,ERR321363,ERR321518,ERR209395,SRR492066,ERR209402,ERR209416,ERR321064,ERR321321,ERR866592,ERR209393,ERR321172,ERR209334,SRR492195,ERR209208,ERR209409,SRR769526,ERR321259,ERR321403,ERR209592,ERR209137,ERR209357,ERR209404,ERR209224,ERR321254,ERR321474,ERR011197,ERR321376,ERR209057,ERR209111,ERR321519,ERR321473,ERR209491,ERR209344,ERR209811,ERR321279,ERR321345,ERR321459,ERR321402,ERR011252,ERR321291,ERR209300,ERR321364,ERR321260,ERR321255,ERR321475,ERR209319,ERR321461,ERR321288"

# Cloud test 1: 100
#metagenome = "ERR414324,SRR1492910,ERR209242,ERR209610,ERR321291,ERR321502,ERR1912985,ERR209077,ERR321255,SRR5558104,ERR209685,ERR321259,SRR6038368,ERR209680,ERR321392,ERR321400,ERR209167,ERR209210,SRR4783481,ERR209216,SRR4305143,ERR414505,ERR526025,ERR209147,ERR209334,ERR209238,ERR209150,ERR209224,ERR209866,ERR1912992,ERR209724,ERR1297656,ERR414508,ERR209203,ERR321064,SRR6028396,SRR4783541,ERR209181,ERR209418,SRR6028195,ERR209085,ERR321254,ERR1293792,ERR321279,ERR1297728,ERR1297731,ERR209244,ERR209094,ERR321414,SRR769534,ERR1293732,ERR209137,ERR321249,ERR866580,ERR209530,SRR1461928,SRR3132485,ERR209676,ERR209785,ERR209300,ERR321378,ERR1293504,ERR209106,SRR4783470,SRR4305313,ERR209501,ERR209349,ERR321412,ERR321364,ERR866584,SRR585752,ERR321260,ERR011117,ERR414258,SRR6038330,ERR209057,SRR609146,ERR321405,SRR6038404,ERR321419,SRR4451588,ERR209144,ERR321301,SRR605618,ERR209151,ERR209140,ERR321288,ERR209121,SRR769526,ERR011131,SRR585727,SRR4423622,ERR209647,ERR209060,ERR209448,SRR4305147,ERR209402,ERR209592,ERR321358,ERR414238"

# Cloud test 2: 100
#metagenome = "ERR866578,ERR321172,SRR4305495,ERR209557,ERR209333,ERR209463,SRR605579,ERR321456,ERR1297837,SRR6038300,ERR321165,ERR1297652,ERR209113,ERR209184,ERR414270,SRR1761665,ERR1912983,ERR011252,ERR209218,ERR209180,SRR6028292,ERR321206,ERR209109,ERR321367,ERR011231,ERR209779,ERR321363,ERR321366,SRR605584,ERR209112,ERR209142,SRR6038352,ERR321519,SRR4408177,ERR209794,ERR209344,ERR209230,ERR011256,ERR209491,ERR1293793,ERR209383,ERR414350,ERR011308,ERR321416,ERR011109,ERR321292,ERR209754,ERR1293555,SRR3132245,SRR492182,SRR585758,ERR1297639,ERR209243,ERR209404,ERR321276,ERR209752,ERR209571,SRR4305137,ERR209636,ERR209575,ERR321280,SRR585750,ERR321316,ERR209799,SRR4783542,ERR209395,SRR6028567,ERR321473,ERR209406,ERR321461,ERR209775,ERR209096,ERR209269,ERR209165,SRR492192,ERR321505,SRR6038331,ERR1293717,ERR209738,ERR321426,ERR1293602,ERR866577,ERR1293603,ERR209139,ERR209868,SRR4305098,SRR4305279,ERR321420,ERR209099,SRR4408108,SRR1219365,SRR4423687,SRR1930176,ERR011092,ERR011114,ERR209641,ERR209149,SRR2992921,SRR6038475,ERR209397"

# Cloud test 3: 100 one of these didnt work : ERR321118
#metagenome = "ERR321341,ERR209795,ERR011154,ERR1293733,ERR1297749,ERR321329,ERR321376,ERR209125,ERR209294,ERR209771,SRR4783477,ERR209239,ERR209391,ERR209303,ERR321457,SRR4305375,ERR414260,ERR209822,SRR6038557,ERR011089,ERR209111,SRR492183,SRR492065,ERR209760,ERR209737,ERR209811,ERR321470,ERR321345,ERR321310,ERR321407,ERR321518,ERR321540,ERR1297721,ERR209417,ERR209645,SRR4305224,ERR1912978,SRR3131941,ERR209082,ERR209396,ERR321067,SRR4305382,SRR4408101,SRR3131896,SRR4444762,ERR209416,ERR209232,ERR209704,SRR4305219,ERR209222,ERR209331,ERR321089,ERR209369,ERR209864,ERR1913016,SRR1438047,SRR4481715,SRR6028178,ERR209133,SRR1449586,ERR209155,ERR321106,ERR321482,ERR209191,ERR321360,ERR1297675,ERR321141,SRR1761666,ERR011166,SRR599573,SRR4305339,ERR209143,ERR209409,ERR209780,ERR209227,ERR209059,ERR321427,SRR4783497,ERR209751,ERR1293677,ERR209206,SRR4481695,SRR4305132,ERR414300,ERR209153,ERR209220,SRR492066,SRR3131876,ERR1293880,SRR6038230,ERR209753,SRR1449526,ERR321459,ERR209602,ERR321351,ERR321307,SRR6038251,ERR209097,ERR209449,SRR6038324"

# Cloud test 4: 100
metagenome = "ERR321231,ERR1913059,ERR209743,ERR321391,ERR209179,ERR209798,ERR321541,SRR492194,SRR2155177,ERR1018296,ERR209585,ERR209723,ERR321129,ERR209302,ERR321406,SRR1491042,SRR599841,ERR1293623,ERR321474,ERR321084,SRR609141,SRR585760,ERR209159,ERR209459,SRR4451590,ERR321435,ERR321515,ERR321415,ERR209450,SRR4451554,ERR209131,SRR4435753,ERR209122,ERR321401,ERR209177,SRR4783544,ERR1297815,ERR321338,ERR321403,ERR209689,ERR321321,ERR209382,ERR209104,ERR321092,SRR6038539,ERR209393,ERR209541,ERR1297713,ERR1293502,SRR3132337,ERR209705,ERR526022,SRR4451574,ERR321460,ERR1293878,ERR209199,SRR4305180,SRR605582,ERR011190,SRR4481702,SRR1462069,SRR1491091,ERR209358,ERR011335,ERR321251,ERR1293585,ERR209525,ERR321517,ERR209321,ERR209236,SRR3131927,SRR4783538,ERR011281,SRR6028415,ERR321101,SRR492195,SRR3132227,ERR209208,ERR321250,ERR321326,ERR209162,SRR1437748,ERR209681,ERR526054,ERR209319,SRR600047,ERR321256,ERR209357,ERR1293604,SRR585747,SRR1765180,ERR011197,ERR321428,ERR209750,SRR1462473,ERR321475,ERR011143,ERR209293,SRR4305218,ERR321539"

metagenomes = metagenome.split(",")

UMGS = "ERR589512_bin.12,SRR341713_bin.18,SRR2155351_bin.3,ERR1297740_bin.24,SRR341590_bin.10,ERR1297644_bin.3,SRR1214724_bin.3,SRR5056929_bin.77,ERR1190829_bin.23,SRR5056786_bin.84,ERR525754_bin.18,SRR3737031_bin.16,ERR1293845_bin.21,SRR5558121_bin.15,ERR1912960_bin.3,SRR6028420_bin.13,ERR1297716_bin.14,SRR4481801_bin.34,SRR5127675_bin.13,SRR2992962_bin.4"
UMGS = UMGS.split(",")

lst = []
lst2 = []
fin = open("bwa_presence-absence.csv", "r")
fout = open("prevalence_t4_p.txt", "w")
for line in fin:
    line.strip('\n')
    temp = line.split(',')
    templst = []
    count = 0
    if temp[0] == "Genome":
        for i in range(len(temp)):
            lst2.append(temp[i])
    if temp[0] in UMGS:
    #if temp[0][0] == 'E' or temp[0][0] == 'S' or temp[0][0] == 'D': # for their results
    #if temp[0][0] == 'U' or temp[0][0] == 'S' or temp[0][0] == 'D': # for our results
        templst.append(temp[0])
        for i in range(1, len(temp)):
            if lst2[i] in metagenomes:
                if temp[i] == "1":
                    count += 1
        templst.append(count)
        lst.append(templst)

"""
sortedlst = sorted(lst, key=itemgetter(1))
print(sortedlst[len(sortedlst)-1][0])
print(lst1[0][1])
for i in range(1,21):
    temp = sortedlst.pop()
    for j in range(len(lst1)):
        if temp[0] == lst1[j][1]:
            fout.write(lst1[j][0])
            fout.write("(")
            fout.write(lst1[j][2])
            fout.write(")")
            fout.write("\t")
            fout.write(str(temp[1]))
            fout.write("\n")
            break
"""
for i in range(len(lst)):
    temp = lst.pop()
    fout.write(temp[0])
    fout.write("\t")
    fout.write(str(temp[1]))
    fout.write("\n")




"""
for i in range(1,21):
    fout.write(sortedlst[len(sortedlst)-i][0])
    fout.write("\t")
    fout.write(str(sortedlst[len(sortedlst)-i][1]))
    fout.write("\n")
#time.sleep(1)
"""


fout.close()
