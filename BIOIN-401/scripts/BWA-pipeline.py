import os
from os import listdir, rename
from os.path import isfile, join

onlyfiles = [f for f in listdir("totals") if isfile(join("totals", f))]

# Run the map2ref.sh pipeline based on what metagenomes were found by test5.py
# Run in ~/

# Run 1
#metagenomes = "ERR011117,ERR209085,ERR209125,ERR209133,ERR209153,ERR209216,ERR209222,ERR209232,ERR209236,ERR209243,ERR209303,ERR209358,ERR209383,ERR209501,ERR209557,ERR209575,ERR209602,ERR209610,ERR209641,ERR209753,ERR209760,ERR209785,ERR321092,ERR321249,ERR321250,ERR321251,ERR321326,ERR321338,ERR321358,ERR321392,ERR321427,ERR321428,ERR414270,ERR526022,ERR866580,ERR866583,SRR492065,SRR492182"
#metagenomes = "ERR011117,ERR209085"
#metagenomes = "ERR209125,ERR209133,ERR209153,ERR209216,ERR209222,ERR209232"
#metagenomes = "ERR209236,ERR209243,ERR209303,ERR209358,ERR209383,ERR209501,ERR209557,ERR209575,ERR209602,ERR209610,ERR209641,ERR209753,ERR209760,ERR209785,ERR321092,ERR321249,ERR321250,ERR321251,ERR321326,ERR321338,ERR321358,ERR321392,ERR321427,ERR321428,ERR414270,ERR526022,ERR866580,ERR866583,SRR492065,SRR492182"

# Run 1.5
#metagenomes = "ERR209216,ERR414270,ERR209243,ERR866584,ERR209794,ERR321460,ERR209094,ERR321067,ERR209636,ERR209077,ERR321084,ERR209206,ERR321412,SRR769534,ERR209383,ERR321101,ERR209099,ERR526025,ERR321338,ERR209751,ERR209303,ERR209575,ERR321392,ERR209242,ERR209610,ERR209085,ERR209785,ERR321428,ERR209530,ERR209155,ERR209230,ERR321089,ERR866580,ERR011131,ERR209822,ERR321406,ERR209109,ERR209557,ERR321307,ERR321407,ERR209396,ERR321141,ERR209676,ERR209369,ERR209641,SRR492194,SRR585752,ERR011092,ERR011117,ERR209417,ERR209133,ERR209203,ERR209779,ERR209349,ERR321251,ERR321427,ERR321310,ERR209585,SRR492183,ERR321426,ERR321250,ERR321326,ERR011126,ERR011335,ERR209602,ERR209232,ERR321540,ERR321358,SRR492182,ERR321515,ERR209753,ERR414350,ERR209222,ERR209125,ERR209358,ERR209647,SRR492065,ERR209147,ERR011114,ERR321414,ERR209082,ERR209227,ERR209210,ERR011166,ERR321092,ERR526022,ERR321249,ERR321351,ERR321366,ERR321415,ERR321106,ERR209501,ERR209153,ERR414505,ERR209236,ERR321367,ERR209760,ERR011109,ERR209244,ERR866584"
#metagenomes = ["ERR866584"]

# Run 2
#metagenomes = "ERR414270,ERR866584,ERR209794,ERR209094,ERR209636,ERR209077,ERR321084,ERR209206,ERR321101,ERR209099,ERR526025,ERR209303,ERR209575,ERR321392,ERR209242,ERR209610,ERR209530,ERR209155,ERR209230,ERR011131,ERR209822,ERR321406,ERR209109,ERR321307,ERR321407,ERR321141,ERR209676,ERR209369,ERR209641,SRR492194,SRR585752,ERR209417,ERR209203,ERR209779,ERR209349,ERR321251,ERR321310,ERR209585,SRR492183,ERR321426,ERR321250,ERR011126,ERR011335,ERR321358,ERR321515,ERR414350,ERR209358,ERR209647,SRR492065,ERR209147,ERR011114,ERR209082,ERR209227,ERR209210,ERR011166,ERR321366,ERR321415,ERR321106,ERR209501,ERR209153,ERR414505,ERR209236,ERR321367,ERR011109,ERR209244,ERR866583"
#metagenomes = "ERR321141,ERR209676,ERR209369,ERR209641,SRR492194,SRR585752,ERR209417,ERR209203,ERR209779,ERR209349,ERR321251,ERR321310,ERR209585,SRR492183,ERR321426,ERR321250,ERR011126,ERR011335,ERR321358,ERR321515,ERR414350,ERR209358,ERR209647,SRR492065,ERR209147,ERR011114,ERR209082,ERR209227,ERR209210,ERR011166,ERR321366,ERR321415,ERR321106,ERR209501,ERR209153,ERR414505,ERR209236,ERR321367,ERR011109,ERR209244,ERR866583"

# DATASET 2
#metagenomes = "ERR209750,ERR209302,ERR209144,ERR209705,ERR209680,SRR585747,ERR209180,ERR209636,ERR321206,ERR321470,SRR585760,ERR209795,ERR209681,ERR209181,ERR209149,ERR209645,ERR209704,ERR209191,ERR209723,ERR209162,ERR209159,ERR321482,ERR414238,ERR209122,ERR209754,ERR209177,ERR209140,ERR209184,ERR209150,ERR209167,SRR599573,ERR209239,ERR209321,ERR209293,ERR321416,ERR321378,ERR209685,ERR209689,ERR209571,ERR209369,ERR209059,ERR209737,SRR609146,SRR605584,SRR585752,ERR209866,ERR209238,ERR209151,ERR414324,ERR011308,ERR209104,SRR600047,ERR209775,ERR321310,ERR209113,ERR209752,ERR209459,SRR609141,SRR585727,ERR209096,SRR492183,SRR492192,ERR209294,SRR585758,SRR605582,ERR209787,ERR209139,SRR605618,ERR011335,ERR414258,ERR209743,ERR321301,ERR011190,ERR209097,ERR321129,ERR321515,ERR011154,ERR209112,ERR011231,ERR414508,ERR209724,ERR209418,ERR209771,ERR321165,SRR599841,ERR209210,ERR209333,ERR209179,ERR209142,ERR414300,ERR209868,SRR585750,ERR209864,ERR414505,SRR605579,ERR209106,ERR321367,ERR321405,ERR209121,ERR209143"

# DATASET 2.1
#metagenomes = "ERR209180,ERR209636,ERR321206,ERR321470,SRR585760,ERR209795,ERR209681,ERR209181,ERR209149,ERR209645,ERR209704,ERR209191,ERR209723,ERR209162,ERR209159,ERR321482,ERR414238,ERR209122,ERR209754,ERR209177,ERR209140,ERR209184,ERR209150,ERR209167,SRR599573,ERR209239,ERR209321,ERR209293,ERR321416,ERR321378,ERR209685,ERR209689,ERR209571,ERR209369,ERR209059,ERR209737,SRR609146,SRR605584,SRR585752,ERR209866,ERR209238,ERR209151,ERR414324,ERR011308,ERR209104,SRR600047,ERR209775,ERR321310,ERR209113,ERR209752,ERR209459,SRR609141,SRR585727,ERR209096,SRR492183,SRR492192,ERR209294,SRR585758,SRR605582,ERR209787,ERR209139,SRR605618,ERR011335,ERR414258,ERR209743,ERR321301,ERR011190,ERR209097,ERR321129,ERR321515,ERR011154,ERR209112,ERR011231,ERR414508,ERR209724,ERR209418,ERR209771,ERR321165,SRR599841,ERR209210,ERR209333,ERR209179,ERR209142,ERR414300,ERR209868,SRR585750,ERR209864,ERR414505,SRR605579,ERR209106,ERR321367,ERR321405,ERR209121,ERR209143"

# DATASET 3
#metagenomes = "ERR209111,SRR492066,ERR209357,ERR209402,ERR321457,ERR866577,ERR209798,ERR209811,ERR209393,ERR321435,ERR321402,ERR321360,ERR414260,ERR321329,ERR321231,ERR321456,ERR321279,ERR321461,ERR321403,ERR209799,ERR321517,ERR321172,ERR209334,ERR209220,ERR209382,ERR209269,ERR209137,ERR209331,ERR209525,ERR209406,ERR011197,ERR321364,ERR209397,ERR209416,ERR011143,ERR321260,ERR321502,SRR492195,ERR209780,ERR321539,ERR321321,ERR321316,ERR321474,ERR321118,ERR209224,ERR321420,ERR321256,ERR011281,ERR209199,ERR321475,ERR209592,ERR321292,ERR209449,ERR209208,ERR526054,ERR321345,ERR209541,ERR209300,ERR011252,ERR209218,ERR321391,ERR321541,ERR321518,ERR209491,ERR321276,ERR321459,ERR321400,ERR011089,ERR209391,SRR769526,ERR321505,ERR321473,ERR209344,ERR209448,ERR321519,ERR866578,ERR321401,ERR321363,ERR321064,ERR209463,ERR321288,ERR866592,ERR209165,ERR321291,ERR321255,ERR321376,ERR321341,ERR321259,ERR209738,ERR011256,ERR209404,ERR209395,ERR321254,ERR321419,ERR209319,ERR209131,ERR209450,ERR209409,ERR209057,ERR209060,ERR209405,ERR321280,ERR209526"

# Test Total
#metagenomes = "ERR321426,ERR209383,ERR526022,ERR321280,ERR321249,ERR209641,ERR209133,ERR209243,ERR321407,ERR866584,ERR321101,ERR209751,ERR209636,ERR321250,ERR321415,ERR209647,ERR321367,ERR209303,ERR209358,SRR492183,ERR011114,ERR321310,ERR209232,ERR209575,ERR209082,SRR492065,ERR209794,ERR209396,ERR321427,ERR209242,ERR321540,ERR011126,ERR321406,ERR209530,ERR321412,ERR209085,ERR321358,ERR209602,ERR321251,ERR321067,ERR414350,ERR209244,ERR321366,ERR209585,ERR321414,ERR526025,ERR321084,SRR492182,ERR209227,ERR209610,ERR209206,ERR321089,ERR321106,ERR011131,ERR209369,ERR321141,ERR209125,SRR769534,ERR209077,ERR321338,ERR209676,ERR209222,ERR414270,ERR209236,ERR321515,ERR011109,ERR011092,ERR209203,ERR209109,ERR321392,ERR209753,ERR209099,ERR209785,ERR209779,ERR866580,ERR209094,ERR321460,ERR209230,ERR209760,ERR209349,ERR209417,ERR209147,ERR209153,ERR011166,ERR321428,ERR209216,ERR321351,SRR492194,ERR011117,ERR321092,SRR585752,ERR209501,ERR011335,ERR321326,ERR209210,ERR414505,ERR209557,ERR209822,ERR321307,ERR209155,ERR209112,ERR321206,ERR209795,ERR209106,ERR209239,ERR209180,ERR209149,ERR209868,ERR209059,SRR609146,ERR209685,ERR209150,ERR011308,ERR209293,ERR321378,ERR321470,ERR209144,ERR209121,ERR209787,ERR414258,ERR209142,ERR209743,ERR209096,ERR209177,ERR209864,ERR209113,ERR209418,ERR209181,ERR209238,ERR209689,ERR209750,ERR414300,SRR600047,SRR605618,ERR209151,ERR209771,ERR209302,SRR599841,ERR321165,SRR585750,ERR209143,ERR209139,ERR209294,ERR209162,SRR585727,ERR209097,SRR609141,ERR209705,SRR585760,ERR321405,ERR209724,ERR209104,SRR599573,ERR209571,ERR209167,SRR585758,ERR209459,SRR585747,ERR209159,ERR209645,ERR209184,ERR321129,ERR011190,ERR209681,SRR605579,ERR209140,ERR011154,ERR414324,ERR209704,ERR209333,ERR321482,SRR492192,ERR209866,ERR321301,ERR209752,SRR605582,ERR209179,ERR209723,ERR209737,ERR209321,ERR414508,ERR209122,ERR209191,ERR321416,ERR209754,SRR605584,ERR414238,ERR209775,ERR011231,ERR209680,ERR209218,ERR011089,ERR209397,ERR321118,ERR209525,ERR321541,ERR209463,ERR321517,ERR209165,ERR209798,ERR209220,ERR209199,ERR866578,ERR321316,ERR321292,ERR321401,ERR209391,ERR321420,ERR209450,ERR209406,ERR011281,ERR321256,ERR414260,ERR209449,ERR209269,ERR321457,ERR321505,ERR209382,ERR209331,ERR321341,ERR209780,ERR321360,ERR011256,ERR209060,ERR526054,ERR321391,ERR209799,ERR321502,ERR321400,ERR321435,ERR321329,ERR011143,ERR209541,ERR321419,ERR321276,ERR209448,ERR209738,ERR321456,ERR866577,ERR321231,ERR321539,ERR209131,ERR321363,ERR321518,ERR209395,SRR492066,ERR209402,ERR209416,ERR321064,ERR321321,ERR866592,ERR209393,ERR321172,ERR209334,SRR492195,ERR209208,ERR209409,SRR769526,ERR321259,ERR321403,ERR209592,ERR209137,ERR209357,ERR209404,ERR209224,ERR321254,ERR321474,ERR011197,ERR321376,ERR209057,ERR209111,ERR321519,ERR321473,ERR209491,ERR209344,ERR209811,ERR321279,ERR321345,ERR321459,ERR321402,ERR011252,ERR321291,ERR209300,ERR321364,ERR321260,ERR321255,ERR321475,ERR209319,ERR321461,ERR321288"

# Cloud test missing a couple ~ 8
metagenomes = "SRR4783542,SRR6038230,ERR321541,ERR321460,ERR321279,ERR321402,SRR6028567,SRR4305495,SRR4783497,SRR585760,SRR3132227,ERR209150,ERR1293792,SRR3131927,ERR209294,ERR1297815,SRR585758,SRR1437748,ERR209140,SRR4305279,ERR526054,ERR321280,ERR321307,ERR209321,ERR1293717,ERR1297713,ERR209645,ERR209077,ERR321474,ERR209647,ERR1293793,SRR4423687,SRR6038404,SRR585747,SRR492192,SRR4305339,ERR321231,ERR321376,ERR1293604,ERR011190,ERR209501,ERR321457,ERR1297749,ERR321250,SRR4435753,ERR321427,ERR209203,SRR6028292,SRR1449526,ERR209180,ERR209585,ERR209206,ERR209125,ERR321165,SRR3131876,ERR321456,ERR321321,ERR209191,SRR4783477,ERR209220,ERR414260,ERR321392,SRR6038324,ERR209530,SRR6038475,ERR1297652,ERR321089,SRR585727,ERR321406,SRR4305137,ERR011143,ERR321366,ERR1297837,SRR4783544,SRR1491091,ERR321141,ERR209216,SRR1462473,SRR6038368,ERR321461,ERR1297721,SRR605584,ERR209681,ERR209232,ERR209723,SRR1492910,ERR1297656,SRR1449586,ERR209085,SRR4305132,SRR4305147,ERR1913016,ERR209104,ERR321420,ERR321260,SRR1761666,SRR1438047,ERR209641,ERR321084,ERR1293733,SRR4305375,ERR011231,ERR1293623,ERR321426,ERR321364,ERR209864,ERR209238,ERR414238,ERR321338,SRR1930176,ERR209300,SRR2992921,ERR321291,SRR4451588,ERR321470,SRR769526,ERR1293878,SRR4305313,ERR1018296,SRR4481702,SRR2155177,ERR321428,ERR321259,ERR209151,SRR4305143,ERR321341,ERR209799,ERR209866,ERR321358,ERR321101,ERR321419,SRR3132485,SRR4305224,SRR4305098,SRR3132337,ERR011092,SRR605582,ERR1912983,ERR1293880,ERR209448,SRR4783541,SRR769534,ERR209099,SRR605618,ERR1297728,ERR209293,ERR209082,ERR866578,ERR321292,ERR321067,ERR209167,SRR4305382,ERR011252,SRR4408101,ERR011197,ERR321316,SRR6038557,SRR6038330,SRR4305218,ERR011256,ERR209395,ERR866580,ERR209222,ERR209184,SRR6038251,ERR209334,SRR4481695,ERR321518,ERR209794,SRR1219365,ERR209463,ERR1293585,ERR414258,ERR209208,ERR209689,ERR209344,ERR1912985,ERR321249,ERR209109,ERR321401,ERR321519,ERR209059,ERR1297639,SRR3131941,SRR1765180,SRR6038539,ERR321345,ERR209592,SRR6028396,SRR4783470,ERR209450,ERR321378,ERR209575,ERR209159,ERR1297731,ERR011154,SRR492066,ERR209779,ERR209113,SRR1461928,ERR1913059,SRR6028195,ERR209242,SRR4408108,ERR1293603,ERR011109,SRR4305219,SRR6038300,ERR209139,ERR1293602,ERR1293502,ERR209822,SRR4451574,ERR209785,ERR321459,SRR4408177,SRR1491042,SRR4305180,ERR209738,ERR1293732,SRR609146,ERR321505,ERR1293504,ERR209775,ERR209096,ERR209795,ERR321326,ERR321407,SRR1462069,SRR5558104,SRR3131896,ERR321172,ERR209144,SRR4451590,SRR1761665,ERR209724,ERR321517,ERR526025,SRR585750,ERR011335,ERR209177,ERR1293677,ERR209780,ERR1912978,ERR209571,ERR209382,SRR6028178,ERR209602,ERR209743,ERR866577,SRR4451554,ERR209753,ERR209227,ERR321064,ERR209094,SRR4423622,ERR209097,ERR209868,ERR414505,SRR4444762,ERR866592,SRR4481715,ERR1297675,ERR1912992,SRR492194,ERR321539,ERR209106,ERR209787,ERR1293555,SRR3132245,SRR6038331,SRR6038352,SRR609141,ERR209404,SRR6028415,SRR4783538,SRR4783481,ERR209798,ERR321482,SRR3132259,ERR209199,SRR6038199,SRR4305177,SRR605579,ERR209418,ERR1293622,SRR1491615,SRR4305157,SRR1930142,ERR321360,SRR3132003,SRR4444829,SRR4423689,SRR599573,ERR209391,ERR321416,ERR321254,ERR1293680,ERR1293679,ERR321255,ERR209636,SRR492182,SRR4305273,ERR209057,SRR599841,ERR321106,ERR209397,ERR321415,ERR414324,ERR011089,ERR209133,ERR1297840,ERR209491,ERR321118,ERR209239,ERR209142,ERR209680,ERR209811,ERR209230,SRR6038190,ERR1913054,ERR209525,SRR4305086,SRR585752,SRR1437837,ERR011114,ERR209210,ERR321414,ERR209383,SRR3132015,SRR4444850,ERR321129,ERR1293503,SRR4305294,SRR1491384,ERR209155,ERR321400,ERR1913119,ERR1297653,SRR1491717,ERR209319,ERR209406,SRR4435705,ERR209060,ERR209409,SRR4435798,ERR321363,ERR321329,SRR4305172,SRR4305163,SRR4435754,ERR1297776,SRR492195,ERR209459,SRR3131708,SRR4305050,SRR6038205,ERR1912994,ERR1293579,ERR1293501,SRR4783545,SRR4305037,ERR011281,ERR209218,ERR526022,ERR321351,ERR209396,ERR209244,ERR321256,ERR209369,ERR414300,SRR1930179,SRR4783539,ERR011126,SRR1761667,ERR1293721,ERR209704,ERR321412,SRR492065,ERR011131,SRR1214319,ERR866584,ERR209153,SRR4305529,SRR4783654,SRR4305388,ERR321251,ERR209269,ERR209112,ERR321310,ERR209302,SRR3132251,ERR209750,ERR209143,ERR321473,ERR1293730,ERR321301,ERR321405,SRR1462058,ERR209416,ERR209224,ERR209111,ERR321435,SRR6028237,SRR6028357,ERR321391,ERR209557,ERR209417,ERR209760,ERR1912966,ERR209449,SRR4444753,ERR209751,ERR209676,SRR4305230,ERR321502,ERR209131,SRR2155323,ERR011117,SRR5963312,SRR4783414,ERR209754,ERR209541,SRR4435687,ERR866583,SRR6028255,ERR1297715,SRR600047,ERR321367,ERR209121,ERR414270,ERR011166,ERR209705,ERR321288,SRR4423625,ERR209165,SRR6038234,SRR1491411,ERR209393,SRR4423608,ERR321515,ERR209685,ERR209162,SRR4305142,SRR3132083,ERR1293577,ERR209752,ERR209358,SRR1449577,SRR4451620,SRR3132311,ERR321092,SRR1930144,ERR209349,SRR2992931,ERR414350,SRR5558110,ERR209333,ERR1297746,ERR321475,ERR209737,ERR209331,ERR1293592,ERR209122,SRR2673279,ERR321403,SRR4305336,SRR5558106,SRR4408180,ERR209771,ERR1297669,ERR414508,ERR209236,SRR492183,ERR209610,SRR5558409,ERR209402,ERR209357,ERR209147,ERR209243,ERR1293554,ERR1912964,ERR209303,ERR209149,ERR321276,SRR4305160,ERR209137,ERR1293731,ERR209181,SRR1491605,ERR321206,SRR6028294,ERR1293601,ERR209179,ERR321540,ERR011308"


#metagenomes = "ERR321426,ERR209383"
metagenomes = metagenomes.split(",")

separator = ""

for meta in metagenomes:

    line0 = ["ref-db-", "", "_total.tab"]
    line0[1] = meta
    temp = separator.join(line0)
    if temp in onlyfiles:
        print("Already processed")
        continue

    #line1 = ["bwa-0.7.16a/bwa mem ref-db.fa metagenomes_gz/", "", "_1.fastq.gz metagenomes_gz/", "", "_2.fastq.gz > ref-db-", "", ".sam"]
    line1 = ["bwa/bwa mem -t 8 ref-db.fa metagenomes_gz/", "", "_1.fastq.gz metagenomes_gz/", "", "_2.fastq.gz > ref-db-", "", ".sam"]
    line1[1] = meta
    line1[3] = meta
    line1[5] = meta
    os.system(separator.join(line1))

    line2 = ["./samtools-1.5/samtools view -@ 7 -uS ref-db-", "", ".sam > ref-db-", "", ".bam"]
    line2[1] = meta
    line2[3] = meta
    os.system(separator.join(line2))

    line3 = ["./samtools-1.5/samtools sort -@ 7 ref-db-", "", ".bam > ref-db-", "", "_s.bam"]
    line3[1] = meta
    line3[3] = meta
    os.system(separator.join(line3))

    line4 = ["./samtools-1.5/samtools index -@ 7 ref-db-", "", "_s.bam"]
    line4[1] = meta
    os.system(separator.join(line4))

    line5 = ["./samtools-1.5/samtools idxstats ref-db-", "", "_s.bam > ref-db-", "", "_depth.tab"]
    line5[1] = meta
    line5[3] = meta
    os.system(separator.join(line5))

    line6 = ["./samtools-1.5/samtools depth ref-db-", "", "_s.bam > ref-db-", "", "_depth-pos.tab"]
    line6[1] = meta
    line6[3] = meta
    os.system(separator.join(line6))

    line7 = ["python3 MGS-gut/scripts/parse_bwa-depth.py ref-db-", "", "_depth.tab ref-db-", "", "_depth-pos.tab > ref-db-", "" ,"_total.tab"]
    line7[1] = meta
    line7[3] = meta
    line7[5] = meta
    os.system(separator.join(line7))

    #line8 = ["mv ref-db-", "", "_total.tab metagenomes/"]
    line8 = ["mv ref-db-", "", "_total.tab totals/"]
    line8[1] = meta
    os.system(separator.join(line8))

    line9 = ["rm ref-db-", "", ".bam ref-db-", "", "_s.bam ref-db-", "", "_s.bam.bai ref-db-", "", "_depth.tab ref-db-", "", "_depth-pos.tab ref-db-", "", ".sam"]
    line9[1] = meta
    line9[3] = meta
    line9[5] = meta
    line9[7] = meta
    line9[9] = meta
    line9[11] = meta
    os.system(separator.join(line9))



"""
bwa mem ref-db.fa ERR321089_1.fastq.gz ERR321089_2.fastq.gz > ref-db-ERR321089.sam
./samtools-1.5/samtools view -@ 7 -uS ref-db-ERR321089.sam > ref-db-ERR321089.bam
./samtools-1.5/samtools sort -@ 7 ref-db-ERR321089.bam > ref-db-ERR321089_s.bam

#non_unique
./samtools-1.5/samtools index -@ 7 ref-db-ERR321089_s.bam
./samtools-1.5/samtools idxstats ref-db-ERR321089_s.bam > ref-db-ERR321089_depth.tab
./samtools-1.5/samtools depth ref-db-ERR321089_s.bam > ref-db-ERR321089_depth-pos.tab
parse_bwa-depth.py ref-db-ERR321089_depth.tab ref-db-ERR321089_depth-pos.tab > ref-db-ERR321089_total.tab

####################################

bwa mem -t 8 ref-db.fa ERR011117_1.fastq.gz ERR011117_2.fastq.gz | ./samtools-1.5/samtools view -@ 7 -uS ref-db-ERR011117.sam > ref-db-ERR011117.bam
./samtools-1.5/samtools view -@ 7 -uS ref-db-ERR011117.sam > ref-db-ERR011117.bam
./samtools-1.5/samtools sort -@ 7 ref-db-ERR011117.bam > ref-db-ERR011117_s.bam

#non_unique
./samtools-1.5/samtools index -@ 7 ref-db-ERR011117_s.bam
./samtools-1.5/samtools idxstats ref-db-ERR011117_s.bam > ref-db-ERR011117_depth.tab
./samtools-1.5/samtools depth ref-db-ERR011117_s.bam > ref-db-ERR011117_depth-pos.tab
parse_bwa-depth.py ref-db-ERR011117_depth.tab ref-db-ERR011117_depth-pos.tab > ref-db-ERR011117_total.tab
"""
